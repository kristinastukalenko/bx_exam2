# [ex2-97] Разработать простой компонент «Новости по интересам»

*Подробное описание задачи смотреть в материалах: [примеры заданий (pdf)](../pubinfo/Ex2AllType.pdf)*

## Общие требования

* У созданного компонента задать код: simplecomp.exam, название: «Простой компонент», раздел для отображения компонента в визуальном редакторе: «Экзамен №2».

* Для решения предоставляются материалы – заготовка компонента, simplecomp.exam-materials. В заготовке создана необходимая файловая структура, и демо-вызов API по выборке. Эти материалы можно не использовать, предоставляются для ускорения решения задания.

* Работу решения продемонстрировать в разделе сайта /ex2/simplecomp/, добавить пункт в главное меню «Экзамен2», и пункт в левом меню «Простой компонент».

## Решение

1) Подготовительные работы. Настройка:

    * Создаём новый раздел и пункт меню;

    * Создаём пользовательское свойство для пользователей - "Тип пользователя" (UF_AUTHOR_TYPE) согласно требованиям;

    * Создать трех тестовых пользователей, логины: test1, test2, test3. Задаём значения свойства «Тип пользователя»;

    * В информационном блоке "Новости" добавляем множественное свойство – "Автор" (AUTHOR_CODE), тип - привязка к пользователю;

    * Добавляем три тестовые новости с произвольным контентом;

    * Задаём значение свойства "Автор" для новостей;

2) Написание компонента:

    * Для ускорения процесса, можно скопировать любой системный компонент Битрикс, в результате вы получите всю необходимую структуру компонента, которую потом сможете отредактировать в соответствии с условиями задания;

    * Копируем заготовку компонента "simplecomp.exam-materials" из материалов;

    * Добавляем описание и параметры компонента:
        * Заготовки можно взять из bitrix/components/bitrix/photo.random/ или bitrix/components/bitrix/news.line, или bitrix/components/bitrix/news.list, заготовка из материалов очень сжата;

    * Логика реализации:
        * Получаем всех пользователей такого же типа, как у текущего, кроме текущего
        * Получаем новости, принадлежащие пользователям такого же типа, как у текущего, кроме текущего
        * Группируем новости по пользователям
        * Получаем количество уникальных новостей для подсчета

Код `class.php` можно посмотреть перейдя по [ссылке](../../local/components/simplecomp/ex2-97/class.php) 

Код `template.php` можно посмотреть перейдя по [ссылке](../../local/components/simplecomp/ex2-97/templates/.default/template.php)
## Полезные ссылки

* [Вебинар: Готовимся в экзамену №2, отложенные функции и кеширование в компонентах](https://www.youtube.com/watch?v=KC6WcgaEWt4&feature=youtu.be)
* [Разработчик Bitrix Framework: Описание компонента](https://dev.1c-bitrix.ru/learning/course/?COURSE_ID=43&LESSON_ID=2828)
* [Разработчик Bitrix Framework: Параметры компонента](https://dev.1c-bitrix.ru/learning/course/?COURSE_ID=43&LESSON_ID=2132)
* [Документация для разработчиков: setResultCacheKeys](https://dev.1c-bitrix.ru/api_help/main/reference/cbitrixcomponent/setresultcachekeys.php)

## P.S.

* Старый демо-сервер использует версию БУС 15.5.1 (PHP 5.5.9), на экзаменационном сервере 16, новом 20, поэтому, во время экзамена могут отсутствовать некоторые современные компоненты.
    * БУС 15.5.1
        * /bitrix/components/bitrix/app.placement/ - компонент отсутствует
        * /bitrix/components/bitrix/security.user.otp.init/class.php

____
* [Задания](tasks.md)
* [README.md](../../README.md)