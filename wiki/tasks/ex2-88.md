# [ex2-88] Оценить скорость работы сайта – страницы и созданный простой компонент «Каталог товаров»

*Подробное описание задачи смотреть в материалах: [примеры заданий (pdf)](../pubinfo/Ex2AllType.pdf)*

## Решаемая задача

* Создать страницу /ex2/time_control/, добавить пункт в главное меню «Экзамен2», и пункт в левом меню «Оценка производительности».

* С помощью специального инструмента Bitrix Framework определить страницу, время генерации которой наибольшее, для этого запустить анализ производительности и открыть все ссылки из верхнего меню по несколько раз. На странице /ex2/time_control/ написать текстом /ex2/time_control/ самую ресурсоемкую страницу и ее долю % в общей статистике нагрузки.

* С помощью специального инструмента Bitrix Framework определить, насколько уменьшается объем кеша при помещении в него только необходимых данных (после измерения – отменить сделанные изменения в коде компонента, что бы они не повлияли на проверку других заданий)
    * Измерить размер кеша при работе компонента «по умолчанию»
    * Измерить размер кеша при помещении в него только данных, необходимых в некешируемой части.
    * Определить разницу и полученный результат записать на странице /ex2/time_control/

## Подобные задачи

* [[ex2-10] Оценить скорость работы сайта – найти самую долгую страницу и самый долгий компонент](./ex2-10.md)
* [[ex2-11] Оценить скорость работы сайта – найти самую долгую страницу и количество запросов](./ex2-11.md)

## Решение

* Создаём раздел /ex2/time_control/

* Отключаем кеширование + Сбрасываем кэш:
    * Настройки > Настройки продукта > Автокеширование

* Настройки > Производительность > Панель производительности

* Нажать на кнопку "Тест производительности" запустить хотя бы на 1 мин

* Во время теста нужно открыть все ссылки из верхнего меню по несколько раз.

* Выписать из результата самую ресурсоемкую страницу, указав её долю % в общей статистике нагрузки.

* Переходим на страницу простого компонента «Каталог товаров». Включаем "Отладка" ("Детальная статистика кеша"). Смотрим размер кэша с CBitrixComponent::setResultCacheKeys и без, сбрасывая кэш.

* Вносим данные на страницу.

* После решения задания, всё вернуть на место, включить кэширование.

## P.S.

* [Экзамен №2. Вопросы и ответы по заданиям. Часть 1, архив.](https://dev.1c-bitrix.ru/support/forum/forum6/topic83477/)
    * [ex2-t12-15] Оценить скорость работы сайта
        * Q: Что имеется ввиду - показать данные средствами API или скопировать результат из "Монитора производительности"?
        * A: Скопировать результат из "Монитора производительности"

* [Экзамен №2. Вопросы и ответы по заданиям](https://dev.1c-bitrix.ru/support/forum/forum6/topic91539/?PAGEN_1=12)
    * Q: [ex2-88] Как то непонятно изложены требования к тестированию компонента. Т.к. предполагается, что компонент пишется с нуля, в $arResult попадают только самые необходимые данные. Кроме того в условиях экзамена прописано, что в компоненте должны кешироваться только используемые в некешируемой части данные. Значит ли это что мы должны убрать SetResultCacheKeys на время тестирования или нужно проделать что-то ещё, например убрать данные, необходимые для работы эрмитажа?
    * A: Да, для выполнения этого задания вы должны временно изменить правильное поведение компонента, все впихнуть в кеш.  про эрмитаж - не участвует в оценке. Не забудьте все изменения вернуть обратно после замеров!

    * По умолчанию, это значит вы не пишите код который влияет на ключи, помещаемые в кеш вовсе

## Полезные ссылки

* [CBitrixComponent::setResultCacheKeys](https://dev.1c-bitrix.ru/api_help/main/reference/cbitrixcomponent/setresultcachekeys.php)

____
* [Задания](tasks.md)
* [README.md](../../README.md)